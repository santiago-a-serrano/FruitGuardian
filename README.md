# Instrucciones para poder generar los datos sintéticos y ejecutar el modelo (ya viene con parámetros pre-entrenados, pero los datos pesan demasiado como para ponerlos aquí)
1. Descargar el siguiente dataset: https://www.kaggle.com/datasets/sriramr/fruits-fresh-and-rotten-for-classification, y descomprimirlo si es necesario.
2. Ejecutar _remove_background.py_, especificando, en la línea 16, dónde está el directorio con los datos del dataset que se descargó en el paso 1, y a qué directorio se quiere que terminen las imágenes sin fondo.
    - Este código elimina el fondo de todas las imágenes PNG en el directorio de origen especificado y sus subdirectorios, guardando las imágenes resultantes con fondos transparentes en las rutas correspondientes bajo el directorio de destino.
3. Ejecutar _image_cleanser.py_, modificando en la penúltima línea del código la dirección al directorio de las frutas sin fondo (o con fondo transparente, mejor dicho).
    - Este código se encarga de eliminar aquellas frutas del dataset que no están completas (la foto está recortada). Al fin y al cabo, no podemos poner frutas recortadas en la canasta. No tiene sentido (así no es una canasta real). También es importante mencionar que se eliminaron algunas imágenes de frutas que contenían frutas repetidas. Sin embargo, como esto se hizo manualmente, no hay un script para eso.
4. Eliminar manualmente, de las frutas sin fondo (después de haber ejecutado el paso 3), aquellas que contengan más de una fruta. Esto tiene que hacerse manualmente. Sin embargo, si no se hace, igualmente funcionará el modelo, solo que con menos precisión, ya que habrá irregularidad de tamaños (tamaños no-realistas, al tener varias frutas en el espacio de solo una).
5. Ejecutar _generate_fruit_baskets.py_. Mirar en las últimas líneas del script, donde se llama a la función _make_one_basket_ repetidas veces, que los directorios coincidan con dónde están los datos. Si no es el caso, hacer la modificación.
    - Este script se encarga de la generación del dataset sintético. El dataset descargado de Kaggle en el paso 1 únicamente contiene frutas podridas y frescas, pero la "gracia" de nuestro modelo es que, con una imagen de una canasta con frutas, se puedan detectar cuáles de ellas están frescas y cuáles podridas. Para esto generamos el dataset sintético, colocando frutas en posiciones, rotaciones y tamaños aleatorios dentro de una canasta.
    - También es importante mencionar que esta función separa datos de validación, entrenamiento y prueba. Las frutas de entrenamiento y validación vienen de los datos "train" del dataset de Kaggle. Las frutas de prueba vienen de los datos "test".
6. Ejecutar _basket_inference.py_, pasando los argumentos correctos a la función infer_one_basket. Los parámetros sam_model y checkpoint_path hacen referencia al modelo de segmentación que se desea usar. Los pesos correspondientes (pre-entrenados) se deben descargar de https://github.com/facebookresearch/segment-anything?tab=readme-ov-file#model-checkpoints.

 
Los pesos pre-entrenados del clasificador de frutas provienen del siguiente trabajo de entrenamiento:
https://www.kaggle.com/code/anshuls235/pytorch-starter/notebook
